(function(){var f="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global?global:this;function h(){f.Symbol||(f.Symbol=k);h=function(){}}var l=0;function k(a){return"jscomp_symbol_"+a+l++}function m(){h();f.Symbol.iterator||(f.Symbol.iterator=f.Symbol("iterator"));m=function(){}}
function p(a){m();if(a[f.Symbol.iterator])return a[f.Symbol.iterator]();if(!(a instanceof Array||"string"==typeof a||a instanceof String))throw new TypeError(a+" is not iterable");var b=0;return{next:function(){return b==a.length?{done:!0}:{done:!1,value:a[b++]}}}}
function q(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a;for(var d in b)if(f.Object.defineProperties){var e=f.Object.getOwnPropertyDescriptor(b,d);void 0!==e&&f.Object.defineProperty(a,d,e)}else a[d]=b[d]}var r;
(function(a){(function(a){var c=void 0;(function(a){a[a.A=65]="A";a[a.D=68]="D";a[a.W=87]="W";a[a.S=83]="S";a[a.LEFT=37]="LEFT";a[a.RIGHT=39]="RIGHT";a[a.UP=38]="UP";a[a.DOWN=40]="DOWN";a[a.ENTER=13]="ENTER";a[a.SPACE=32]="SPACE";a[a.NUM_1=49]="NUM_1";a[a.NUM_2=50]="NUM_2";a[a.NUM_3=51]="NUM_3";a[a.NUM_4=52]="NUM_4";a[a.NUM_5=53]="NUM_5";a[a.C=67]="C"})(c=a.R||(a.R={}));var d=void 0;(function(a){a[a.UP=0]="UP";a[a.DOWN=1]="DOWN";a[a.LEFT=2]="LEFT";a[a.RIGHT=3]="RIGHT";a[a.ACTION=4]="ACTION"})(d=a.o||
(a.o={}));a.j=[];a.j[d.H]=[c.sa,c.H];a.j[d.K]=[c.na,c.K];a.j[d.T]=[c.ha,c.T];a.j[d.U]=[c.ja,c.U];a.j[d.J]=[c.oa,c.ka];for(var e=[],n=[],g=[],c=0;256>c;c++)n[c]=!0;a.wa=function(a){return e[a]};a.za=function(a){var b=g[a];g[a]=!1;return b};a.ta=function(){for(var a in g)g[a]=!1};a.ba=function(a){a=a.which;e[a]=!0;n[a]&&(g[a]=!0);n[a]=!1};a.ca=function(a){a=a.which;e[a]=!1;n[a]=!0};a.va=function(c){var d=!1;c=p(a.j[c]);for(var g=c.next();!g.done;g=c.next())g=g.value,d=d||e[g];return d};a.w=function(c){var d=
!1;c=p(a.j[c]);for(var e=c.next();!e.done;e=c.next())e=e.value,d=d||g[e],g[e]=!1;return d}})(a.f||(a.f={}))})(r||(r={}));function t(a,b,c){this.a=b;this.b=a;this.s=c;v.G.add("sheet","./sheet.png");v.G.load(this.u.bind(this))}
t.prototype.u=function(){this.i=new w(this.a);this.b.addEventListener("resize",this.g.bind(this),!1);this.g();this.b.onkeydown=r.f.ba;this.b.onkeyup=r.f.ca;this.b.onblur=this.i.pause.bind(this.i);this.b.onfocus=this.i.fa.bind(this.i);this.X=new x(this.s);this.i.h.register("main-menu",new y(this));this.i.h.register("game-screen",new z(this));this.i.h.push("main-menu");var a=this.i;a.O=window.requestAnimationFrame(a.N.bind(a))};
t.prototype.g=function(){var a=Math.min(window.innerWidth/this.a.width,window.innerHeight/this.a.height)|0,a=0>=a?1:a,b=[this.a.width*a,this.a.height*a],c=[(window.innerWidth-b[0])/2,(window.innerHeight-b[1])/2],b=document.getElementById("stage"),a="translate("+~~c[0]+"px, "+~~c[1]+"px) scale("+~~a+")";b.style.transform=a;b.style.webkitTransform=a};var A=t||(t={});A.a=512;A.b=288;A.g=8;function B(a){this.g=a;this.c=!0;this.l=!1}B.prototype.m=function(){this.c=!0;this.update(0)};
B.prototype.v=function(){this.c=!0;this.update(0)};function C(){this.b={};this.a=[]}C.prototype.register=function(a,b){this.b[a]=b};C.prototype.push=function(a){this.current&&this.current.v();this.a.push(this.b[a]);this.current&&this.current.m()};C.prototype.pop=function(){this.current&&this.current.v();this.a.pop();this.current&&this.current.m()};Object.defineProperties(C.prototype,{current:{configurable:!0,enumerable:!0,get:function(){return this.a[this.a.length-1]}}});
function w(a){this.g=this.c=this.I=!1;this.b=a;this.a=this.b.getContext("2d");this.a.ea=!1;this.a.aa=!1;this.s=document.createElement("canvas");this.s.width=this.b.width;this.s.height=this.b.height;this.u=this.s.getContext("2d");this.u.ea=!1;this.u.aa=!1;this.h=new C}w.prototype.update=function(a){this.g||this.h.current.update(a)};
w.prototype.B=function(){if(this.I||this.h.current.l)this.a.clearRect(0,0,this.b.width,this.b.height),this.u.clearRect(0,0,this.b.width,this.b.height),this.I=this.h.current.l=!1;this.g||!this.c&&!this.h.current.c?this.g&&this.c&&(this.a.globalAlpha=.7,this.a.fillStyle="black",this.a.fillRect(0,0,t.a,t.b),this.a.globalAlpha=1,this.c=this.h.current.c=!1):(this.h.current.B(this.u),this.a.drawImage(this.s,0,0,t.a,t.b,0,0,t.a,t.b),this.c=this.h.current.c=!1)};
w.prototype.N=function(){var a=window.performance.now(),b=a-this.then;this.then=a;this.update(b);this.B();this.O=window.requestAnimationFrame(this.N.bind(this))};w.prototype.stop=function(){window.cancelAnimationFrame(this.O)};w.prototype.pause=function(){this.c=this.g=!0};w.prototype.fa=function(){this.g=!1;this.h.current.c=this.I=!0};function x(a){this.V=a}function D(){this.L=300;this.$=2E3;this.shape="square";this.ga=this.F=1}function E(a){this.name=a}
function F(a,b){this.P=void 0===a?0:a;this.M=void 0===b?0:b}function G(a,b){this.x=void 0===a?0:a;this.y=void 0===b?0:b}var H;
(function(a){function b(a,b){this.name=a;this.value=b}function c(a,b){this.name=a;this.value=b}function d(a){this.name="sprite";this.value=a}function e(a){this.name="style";this.value=a}function n(a){var b=void 0===a.x?0:a.x;a=void 0===a.y?0:a.y;this.name="position";this.value=new G(b,a)}function g(a){var b=void 0===a.P?0:a.P;a=void 0===a.M?0:a.M;this.name="aabb";this.value=new F(b,a)}q(g,E);a.ia=g;q(n,E);a.ma=n;q(e,E);a.qa=e;q(d,E);a.pa=d;q(c,E);a.ra=c;q(b,E);a.la=b})(H||(H={}));var v;
(function(a){var b={};a.ua=function(a){return b[a]};var c={},d=0;(function(a){a.add=function(a,b){c[a]=b;d++};a.load=function(a){function e(a){a.Z++===a.da&&a.Y()}a={Z:0,da:0,Y:a};for(var u in c)b[u]=new Image,b[u].src=c[u],b[u].onload=e.bind(this,a),delete c[u];d=0}})(a.G||(a.G={}))})(v||(v={}));var I;(function(a){var b={};a.ya=function(a){b[a.name]=a};a.xa=function(a){return b[a]}})(I||(I={}));function z(a){B.call(this,a)}q(z,B);z.prototype.m=function(){this.l=!0;B.prototype.m.call(this)};
z.prototype.v=function(){B.prototype.v.call(this)};
z.prototype.update=function(){r.f.w(r.f.o.J)&&this.g.i.h.pop();if(r.f.w(r.f.o.H)){var a=new D,b=this.g.X.V,c=b.createOscillator(),d=b.createGain(),e=a.ga||1;c.type=a.shape;c.frequency.setValueAtTime(a.L,b.currentTime);c.frequency.exponentialRampToValueAtTime(a.$,b.currentTime+a.F/2);c.frequency.exponentialRampToValueAtTime(a.L,b.currentTime+a.F);d.gain.setValueAtTime(e,b.currentTime);d.gain.exponentialRampToValueAtTime(.001,b.currentTime+a.F);c.connect(d);d.connect(b.destination);c.start(b.currentTime);
c.stop(b.currentTime+a.F)}};z.prototype.B=function(a){this.c&&(a.globalAlpha=1,a.fillStyle="blue",a.fillRect(0,0,~~t.a,~~t.b),a.globalAlpha=.75,a.textAlign="center",a.fillStyle=a.strokeStyle="yellow",a.lineWidth=2,a.fillText("This is the game screen, baby.",~~(t.a/2|0),64))};function y(a){B.call(this,a);this.a=0;this.b=["Start","Options","Exit"]}q(y,B);y.prototype.m=function(){this.l=!0;B.prototype.m.call(this)};y.prototype.v=function(){this.l=!0;B.prototype.m.call(this)};
y.prototype.update=function(){if(r.f.w(r.f.o.J))switch(this.a){case 0:this.g.i.h.push("game-screen");break;case 1:break;default:window.location.reload()}r.f.w(r.f.o.K)&&(this.a=(this.a+1)%this.b.length,this.c=this.l=!0);r.f.w(r.f.o.H)&&(this.a=0===this.a?this.b.length-1:(this.a-1)%3,this.c=this.l=!0)};
y.prototype.B=function(a){if(this.c){a.globalAlpha=1;a.font="18px Verdana";a.textAlign="center";a.fillStyle=a.strokeStyle="black";a.lineWidth=2;a.fillText("js13k 2017",~~(t.a/2|0),64);for(var b=0;b<this.b.length;b++)a.fillText(this.b[b],~~(t.a/2|0),~~((t.b|0)-36*this.b.length+36*b));a.strokeRect(~~(t.a/2-75),~~(t.b-36*this.b.length+36*this.a-18),150,24)}};}).call(window);
